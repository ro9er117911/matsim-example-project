# Changelog - November 2025

## 2025-11-05

### Documentation Restructure
- **Reorganized all documentation** into hierarchical structure
- Created `docs/` directory with 6 focused guides
- Archived old `working_journal/` to `archive/`
- Simplified README.md and CLAUDE.md

**New Docs Structure**:
```
docs/
├── 1-quick-start.md        - Getting started
├── 2-architecture.md       - System overview
├── 3-public-transit.md     - Complete PT guide
├── 4-agent-development.md  - Population creation
├── 5-configuration.md      - Config reference
└── 6-troubleshooting.md    - Common issues
```

### Test Population Generator
- Added `generate_test_population.py` - Python script for generating test populations
- Created `test_population_50.xml` - 50 agents for Taipei metro testing
  - 30 PT agents (all 5 lines: BL, G, O, R, BR)
  - 15 car agents
  - 5 walk agents
  - Peak/off-peak distribution
  - Transfer stations included (BL02, G02, O02, R02, BR03)

## 2025-11-04

### Vehicle Filtering Implementation
- Added vehicle filtering in `build_agent_tracks`
- Created `VehicleFilterer.py` for filtering tracked vehicles
- Generates vehicle usage reports

### PT + Car Success
- Successfully ran multimodal simulation (PT + car agents)
- Validated PT sequential routing with SwissRailRaptor
- Confirmed correct stop visitation in events

## 2025-11-03

### PT SwissRailRaptor Fix
- **Fixed PT direct transmission issue**
- Removed PT from teleported modes
- Configured SwissRailRaptor for sequential routing
- PT agents now visit all intermediate stops

### Documentation Updates
- Updated CLAUDE.md with SwissRailRaptor configuration
- Added PT troubleshooting section
- Documented configuration best practices

### Code Refactoring
- Refactored `build_agent_tracks` into modular components:
  - `EventReader.py` - Event file processing
  - `TrackBuilder.py` - Track data building
  - `TrackWriter.py` - Output generation
  - `VehicleFilterer.py` - Vehicle filtering

## 2025-10-29

### Initial PT Setup
- Set up GTFS-to-MATSim pipeline
- Created PT tools in `src/main/java/org/matsim/project/tools/`
- Integrated pt2matsim-25.8-shaded.jar
- Initial PT error handling documentation

---

## Breaking Changes

None in November 2025.

## Migration Guide

### For Users with Old Documentation Layout

Old documentation locations → New locations:

| Old | New |
|-----|-----|
| `AGENT.md` | `docs/4-agent-development.md` |
| `PT_ERROR_HANDLING.md` | `docs/3-public-transit.md` + `docs/6-troubleshooting.md` |
| `PT_SETUP_REPORT.md` | `docs/3-public-transit.md` |
| `REFACTORING_SUMMARY.md` | `changelog/2025-11.md` |
| `working_journal/*.md` | `archive/working_journal/` |

### For AI Assistants

- **Primary reference**: `CLAUDE.md` (simplified)
- **Detailed guides**: `docs/` directory
- **Config reference**: `defaultConfig.xml` + `docs/5-configuration.md`
- **Archived logs**: `archive/working_journal/`

---

## Deprecated

- `AGENT.md` - Replaced by `docs/4-agent-development.md`
- `PT_ERROR_HANDLING.md` - Merged into `docs/3-public-transit.md`
- `PT_SETUP_REPORT.md` - Merged into `docs/3-public-transit.md`
- `REFACTORING_SUMMARY.md` - Content moved to changelog
- `working_journal/` - Moved to `archive/`

---

## Coming Soon

- Additional test scenarios for all Taipei metro lines
- Performance benchmarking results
- Advanced PT mapping configurations
- CI/CD integration
